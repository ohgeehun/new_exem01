<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//iBATIS.com//DTD SQL Map 2.0//EN"
    "http://www.ibatis.com/dtd/sql-map-2.dtd">

<sqlMap namespace="sch">
	<typeAlias alias="SchBean" 
			   type="com.exem9.lms.web.schedule.bean.SchBean" />	
	
	<resultMap class="SchBean" id="SchMap">
		<result property="schCusId" column="customer_id"/>
		<result property="schCusNm" column="customer_name"/>
		<result property="schPjtId" column="project_id"/>
		<result property="schPjtNm" column="project_name"/>
		
		<result property="user_id" column="user_id"/>
		<result property="user_name" column="user_name"/>
		<result property="team_id" column="team_id"/>
		<result property="team_name" column="team_name"/>
		<result property="dbms_id" column="dbms_id"/>
		<result property="dbms_name" column="dbms_name"/>
		<result property="category_id" column="category_id"/>
		<result property="category_name" column="category_name"/>
		<result property="start_time" column="start_time"/>
		<result property="end_time" column="end_time"/>
		<result property="contents" column="contents"/>
	</resultMap>

	<select id="getsch" resultMap="SchMap">
	SELECT s.support_id, 
      s.user_id, m.user_name,
      s.team_id, t.team_name,
      s.customer_id, c.customer_name,
      s.project_id, p.project_name,
      s.dbms_id, d.dbms_name,
      s.category_id, ca.category_name,
       s.start_time, s.end_time, s.contents
  FROM xm_support_history s,
	xm_member m,
	xm_team t,
	( 
	   select customer_id, customer_name
	   from xm_customer 
	   group by customer_id, customer_name
	) c,
	( 
	   select customer_id, project_id, project_name
	   from xm_customer 
	   group by customer_id, project_id, project_name
	) p,
	xm_dbms d,
	xm_category ca
  where s.user_id = m.user_id and
	s.team_id = t.team_id and
	s.customer_id = c.customer_id and
	s.project_id = p.project_id and
	s.dbms_id = d.dbms_id and
	s.category_id = ca.category_id
	</select>  	
</sqlMap>